<!-- Updated Weekly Scheduler (with improved kitchen checkmarks, gender defaults, and default tasks) -->
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Weekly Scheduler</title>
<style>
  body { font-family: Arial, sans-serif; margin: 20px; background: #fafafa; }
  h1 { text-align: center; }
  table { border-collapse: collapse; width: 100%; margin-top: 10px; }
  th, td { border: 1px solid #ccc; padding: 8px; text-align: center; }
  th { background-color: #eee; }
  input[type="checkbox"] { transform: scale(1.3); }
  .button { margin: 5px; padding: 5px 10px; }
</style>
</head>
<body>
<h1>Weekly Scheduler</h1>

<section id="peopleSection">
  <h2>People</h2>
  <button id="addPersonBtn" class="button">Add Person</button>
  <table id="peopleTable">
    <thead>
      <tr><th>Name</th><th>Gender</th><th>Availability</th></tr>
    </thead>
    <tbody></tbody>
  </table>
</section>

<section id="kitchenTasksSection">
  <h2>Kitchen Tasks</h2>
  <button id="addKitchenTaskBtn" class="button">Add Task</button>
  <table id="kitchenTasksTable">
    <thead>
      <tr><th>Task</th><th># People</th></tr>
    </thead>
    <tbody></tbody>
  </table>
</section>

<section id="workDutySection">
  <h2>Work Duty</h2>
  <button id="addWorkTaskBtn" class="button">Add Work Duty</button>
  <table id="workTasksTable">
    <thead>
      <tr><th>Task</th><th># People</th><th>Gender</th></tr>
    </thead>
    <tbody></tbody>
  </table>
</section>

<button id="generateBtn" class="button">Generate Schedule</button>

<section id="scheduleSection">
  <h2>Generated Kitchen Schedule</h2>
  <table id="kitchenScheduleTable">
    <thead></thead>
    <tbody></tbody>
  </table>
  <h2>Fairness Summary</h2>
  <table id="summaryTable">
    <thead><tr><th>Name</th><th>Total Tasks</th></tr></thead>
    <tbody></tbody>
  </table>
</section>

<script>
const people = [];
const kitchenTasks = [];
const workTasks = [];

function createDefaultKitchenTasks() {
  const defaults = ["Breakfast", "Lunch", "Lunch Dishes", "Dinner", "Dinner Dishes"];
  defaults.forEach(task => {
    kitchenTasks.push({ name: task, count: 2 });
  });
  renderKitchenTasks();
}

function renderPeople() {
  const tbody = document.querySelector('#peopleTable tbody');
  tbody.innerHTML = '';
  people.forEach((p, i) => {
    const row = document.createElement('tr');
    const nameCell = document.createElement('td');
    nameCell.textContent = p.name;

    const genderCell = document.createElement('td');
    const genderSelect = document.createElement('select');
    ['Male', 'Female'].forEach(g => {
      const opt = document.createElement('option');
      opt.value = g;
      opt.textContent = g;
      if (p.gender === g) opt.selected = true;
      genderSelect.appendChild(opt);
    });
    genderSelect.addEventListener('change', e => p.gender = e.target.value);
    genderCell.appendChild(genderSelect);

    const availCell = document.createElement('td');
    const availBox = document.createElement('input');
    availBox.type = 'checkbox';
    availBox.checked = p.available;
    availBox.addEventListener('change', e => p.available = e.target.checked);
    availCell.appendChild(availBox);

    row.appendChild(nameCell);
    row.appendChild(genderCell);
    row.appendChild(availCell);
    tbody.appendChild(row);
  });
}

function renderKitchenTasks() {
  const tbody = document.querySelector('#kitchenTasksTable tbody');
  tbody.innerHTML = '';
  kitchenTasks.forEach((task, i) => {
    const row = document.createElement('tr');
    const nameCell = document.createElement('td');
    const nameInput = document.createElement('input');
    nameInput.value = task.name;
    nameInput.addEventListener('input', e => task.name = e.target.value);
    nameCell.appendChild(nameInput);

    const countCell = document.createElement('td');
    const countInput = document.createElement('input');
    countInput.type = 'number';
    countInput.min = 1;
    countInput.value = task.count;
    countInput.addEventListener('change', e => task.count = parseInt(e.target.value));
    countCell.appendChild(countInput);

    row.appendChild(nameCell);
    row.appendChild(countCell);
    tbody.appendChild(row);
  });
}

function renderWorkTasks() {
  const tbody = document.querySelector('#workTasksTable tbody');
  tbody.innerHTML = '';
  workTasks.forEach((task, i) => {
    const row = document.createElement('tr');

    const nameCell = document.createElement('td');
    const nameInput = document.createElement('input');
    nameInput.value = task.name;
    nameInput.addEventListener('input', e => task.name = e.target.value);
    nameCell.appendChild(nameInput);

    const countCell = document.createElement('td');
    const countInput = document.createElement('input');
    countInput.type = 'number';
    countInput.min = 1;
    countInput.value = task.count;
    countInput.addEventListener('change', e => task.count = parseInt(e.target.value));
    countCell.appendChild(countInput);

    const genderCell = document.createElement('td');
    const genderSelect = document.createElement('select');
    ['Any', 'Male', 'Female'].forEach(g => {
      const opt = document.createElement('option');
      opt.value = g;
      opt.textContent = g;
      if (task.gender === g) opt.selected = true;
      genderSelect.appendChild(opt);
    });
    genderSelect.addEventListener('change', e => task.gender = e.target.value);
    genderCell.appendChild(genderSelect);

    row.appendChild(nameCell);
    row.appendChild(countCell);
    row.appendChild(genderCell);
    tbody.appendChild(row);
  });
}

document.getElementById('addPersonBtn').onclick = () => {
  people.push({ name: 'Person ' + (people.length + 1), gender: 'Male', available: true });
  renderPeople();
};

document.getElementById('addKitchenTaskBtn').onclick = () => {
  kitchenTasks.push({ name: 'New Task', count: 1 });
  renderKitchenTasks();
};

document.getElementById('addWorkTaskBtn').onclick = () => {
  workTasks.push({ name: 'New Duty', count: 1, gender: 'Any' });
  renderWorkTasks();
};

document.getElementById('generateBtn').onclick = generateSchedule;

function generateSchedule() {
  if (people.length === 0 || kitchenTasks.length === 0) return;
  const scheduleBody = document.querySelector('#kitchenScheduleTable tbody');
  const scheduleHead = document.querySelector('#kitchenScheduleTable thead');
  scheduleHead.innerHTML = '';
  scheduleBody.innerHTML = '';

  const headRow = document.createElement('tr');
  headRow.innerHTML = '<th>Task</th>' + people.map(p => `<th>${p.name}</th>`).join('');
  scheduleHead.appendChild(headRow);

  const summary = people.map(p => ({ name: p.name, total: 0 }));

  kitchenTasks.forEach(task => {
    const row = document.createElement('tr');
    const nameCell = document.createElement('td');
    nameCell.textContent = task.name;
    row.appendChild(nameCell);

    const available = people.filter(p => p.available);
    available.sort(() => Math.random() - 0.5);
    available.sort((a, b) => summary.find(s => s.name === a.name).total - summary.find(s => s.name === b.name).total);
    const selected = available.slice(0, task.count);

    people.forEach(p => {
      const td = document.createElement('td');
      if (selected.includes(p)) {
        td.textContent = 'âœ“';
        const s = summary.find(s => s.name === p.name);
        s.total++;
      }
      row.appendChild(td);
    });
    scheduleBody.appendChild(row);
  });

  renderSummary(summary);
}

function renderSummary(summary) {
  const tbody = document.querySelector('#summaryTable tbody');
  tbody.innerHTML = '';
  summary.forEach(s => {
    const row = document.createElement('tr');
    row.innerHTML = `<td>${s.name}</td><td>${s.total}</td>`;
    tbody.appendChild(row);
  });
}

createDefaultKitchenTasks();
renderKitchenTasks();
</script>
</body>
</html>
